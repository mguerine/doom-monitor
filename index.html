<!doctype html>
<html lang="en">
	<head>
		<title>Doom Gauntlet - Monitor</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="icon" type="image/x-icon" href="images/Dark_Father.ico">
		<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,700' el='stylesheet' type='text/css'>
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">	
		<link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" href="css/header.css">
		
	</head>
	<body>
		<div class="header">
			<img src="images/Dark_Father.ico" alt="logo" height="50">
			<a href="#" class="logo">Doom Gauntlet - Monitor</a>
			<div class="header-right">
				<a href="#contact">Contact</a>
				<a href="#about">About</a>
			</div>
		</div>
		<section class="ftco-section">
			<div class="container">				
				<div class="table-wrap">
					<table class="table table-responsive-x1">
						<thead>
							<tr>
								<th>Player</th>
								<th>Char</th>
								<th>Status</th>
							</tr>
						</thead>
						<tbody id="print_table">
							
						</tbody>
					</table>
				</div>
			</div>
		</section>
		<script>
			var url = 'https://doom-monitor-api.herokuapp.com'
			var xhr = new XMLHttpRequest()
			xhr.open('GET', url, true)
			xhr.onreadystatechange = () => {
				if (xhr.readyState === XMLHttpRequest.DONE) {
					const res = JSON.parse(xhr.responseText);
					//document.getElementById("print_table").innerHTML = xhr.responseText;
					for (const key in res){	
						// ---- CREATING TABLE ROW
						var row = document.createElement("tr");	
						row.setAttribute('class', 'alert');
						row.setAttribute('role', 'alert');
						
						// ---- CREATING TABLE COLUMN 1
						var col1 = document.createElement("td");	
						col1.setAttribute('class', 'd-flex align-items-center'); 
						
						//col1.innerHTML = res[key][0];
						
						// ---- DIV ELEMENT 1	
						var div1 = document.createElement("div");	
						div1.setAttribute('class', 'img'); 
						div1.setAttribute('style', 'background-image: url(images/user.png);'); 

						col1.appendChild(div1);
						// ---- DIV ELEMENT 2	
						var div2 = document.createElement("div");	
						div2.setAttribute('class', 'pl-3 email'); 
						div2.innerHTML = '<span>user@email.com</span><span>Last Seen: '+ res[key][1] +'</span>';
						col1.appendChild(div2);
						row.appendChild(col1);
						// ---- END CREATING TABLE COLUMN 1	

						// ---- CREATING TABLE COLUMN 2
						var col2 = document.createElement("td");	
						col2.setAttribute('class', 'char_name'); 
						col2.innerHTML = key;
						row.appendChild(col2);
						// ---- END CREATING TABLE COLUMN 2	

						// ---- CREATING TABLE COLUMN 3
						var col3 = document.createElement("td");	
						col3.setAttribute('class', 'status'); 
						if (res[key][0]){ 
							col3.innerHTML = '<span class="active"> on </span>'
						} else {
							col3.innerHTML = '<span class="off"> off </span>' 
						};
						row.appendChild(col3);						
						// ---- END CREATING TABLE COLUMN 3	

						//tr_el.innerHTML = '<span>' +  + '</span>';
						const box = document.getElementById("print_table");
						box.appendChild(row);
						console.log(`${key} : ${res[key]}`)										
					}					
				}
			};
			xhr.onerror = function(err) { console.error(err) }
			xhr.send()
		</script>

		<script src="js/jquery.min.js"></script>
		<script src="js/popper.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/main.js"></script>

	</body>
</html>

